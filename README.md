# Прогнозирование спроса на такси

![comments_nlp](https://www.traveller.com.au/content/dam/images/h/0/q/y/v/d/image.related.articleLeadwide.620x349.h0qylt.png/1517386967950.jpg)

## Описание проекта

**ЦЕЛЬ ПРОЕКТА:**

Для `сервиса такси` построить модель прогнозирования **количества заказов на следующий час**.

Это позволит эффективно `управлять ресурсами` и привлекать большее количество таксистов `в пиковые часы`.

Целевой KPI - **RMSE <= 48**

---

**ЛИЧНЫЕ ЦЕЛИ:**

Научиться базовым принципам работы **с временными рядами** и определять их характеристики:
 - cтационарность 
 - сезонность
 - тренды
 
Испытать на практике возможности статистической автокорреляции `PCAF` и `ACF`, метод **дифференцирования**, а также познакомиться с возможностями бустера **XGBoost**.

[Посмотреть проект](Taxi_demand_prediction_v1.ipynb)

## Новые навыки 

<div class="alert alert-success">
<br> ✔️ Анализ и дифференцирование временных рядов   ✔️ Upsampling  </br>
<br> ✔️ Исследование стационарности  ✔️ Тест Дики — Фуллера </br>
<br> ✔️ Автокорреляция и визуализация ACF& PACF ✔️ Сезонная декомпозиция </br>
<br> ✔️ Генерация календарных и lag-признаков  ✔️ rolling-window признаки</br>
<br> ✔️ Модель XGBoost </br>
</div>

## Этапы исследования

Для достижения цели мы воспользовались разными подходами:

1. Провели детальный анализ **динамики заказов** и `сезонности`

2. Исследовали **стационарность** временного ряда:

   - Тест Дики-Фуллера
   - Сэмплирование и дифференцирование
   - Поиск закономерностей с помощью **автокорреляции** `ACF`

2. Сгенерировали **признаки 3-х типов** для SupervisedLearning:
    - Лаги
    - Календарные признаки
    - "Скользящие" статистики (rolling-window)
    
3. Для **отбора признаков** использовали:
   - Статистические графики с **автокорреляцией** `PACF` и `ACF`
   - `FeatureImportance` Линейной Регрессии и XGBoost

4. Провели анализ ошибок и **выявили аномалии**, что позволило `улучшить результаты`.

5. **Визуализировали** предсказания для `оценки качества` построенной модели

Также познакомились с возможностями **XGBoost**, который в текущем проекте показал большую **устойчивость** к `overfitting`, чем RandomForest.

## Результат проекта

Мы успешно построили `forecasting` модель для предсказания **спроса на такси** в ближайший час.

Лучшие результаты на всех этапах показала **Линейная Регрессия**:

==> Кросс-валидация

- RMSE:  24.06 | MAE :  18.63 - обучающий датасет

- RMSE:  31.01 | MAE :  24.08 - валидационная выборка

==> Тест

- RMSE:  24.87 | MAE :  19.22 - обучающий датасет

- **RMSE:  36.41 | MAE :  29.04 - тестовая выборка**

Поставленный KPI с `RMS <= 48` достигнут! 

**Возможности для развития проекта:**

- Добавить в качестве признаков результаты `дифференцирования`
- Использовать для предсказаний готовые модели, например, **fbpropet**

## Исходные данные

```python
import pandas as pd

pd.set_option("display.max_colwidth", 500)
df = pd.read_csv("/datasets/toxic_comments.csv")

df.sample(5)
```
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>num_orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13640</th>
      <td>2018-06-03 17:20:00</td>
      <td>11</td>
    </tr>
    <tr>
      <th>167</th>
      <td>2018-03-02 03:50:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>24054</th>
      <td>2018-08-15 01:00:00</td>
      <td>51</td>
    </tr>
    <tr>
      <th>8732</th>
      <td>2018-04-30 15:20:00</td>
      <td>9</td>
    </tr>
    <tr>
      <th>24587</th>
      <td>2018-08-18 17:50:00</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
